# 지원되는 요구사항 문서 형식

## 현재 지원 형식

### ✅ 완전 지원

1. **텍스트/마크다운 직접 입력**
   - 형식: 일반 텍스트, 마크다운
   - 입력 방법: UI의 "텍스트 입력" 탭에 직접 붙여넣기
   - 파싱 방식:
     - 따옴표로 감싼 텍스트 추출 (`"인기순"`)
     - "/" 로 구분된 옵션 추출 (`최신순 / 조회순 / 인기순`)
     - UI 키워드 기반 필터링
   - 예시:
     ```
     리스트 : 최신순 / 조회순 / 인기순
     "필터" 버튼 노출
     ```

2. **Confluence 위키 (HTML)**
   - 형식: Confluence 페이지 HTML
   - 입력 방법: "위키 링크" 탭에 URL 입력
   - 파싱 방식:
     - HTML 표 파싱 (cheerio 사용)
     - 섹션 선택 UI로 원하는 부분만 추출
     - 표 내부의 헤더 행 자동 감지
     - Confluence 매크로 제거 (`ac:structured-macro`, `ac:inline-comment-marker` 등)
   - 지원 기능:
     - 표 형식 요구사항 추출
     - 섹션별 선택적 추출
     - 헤더 행 자동 감지
   - 예시: Confluence 표에서 "NO", "항목", "속성", "내용" 컬럼 추출

3. **PDF 파일**
   - 형식: PDF (텍스트 추출 가능한 PDF만)
   - 입력 방법: "PDF 업로드" 탭에서 파일 선택
   - 파싱 방식:
     - `pdf-parse` 라이브러리로 텍스트 추출
     - 텍스트 정리 (공백, 줄바꿈 정리)
     - 이후 텍스트 파싱 로직 적용
   - 제한사항:
     - 텍스트 레이어가 있는 PDF만 지원
     - 이미지 기반 PDF (스캔본)는 지원하지 않음
     - 표 구조는 텍스트로만 추출됨 (표 구조 정보 손실)

### ⚠️ 부분 지원

4. **HTML 표 (일반)**
   - 형식: HTML `<table>` 태그
   - 입력 방법: 텍스트 입력에 HTML 직접 붙여넣기
   - 파싱 방식:
     - cheerio로 표 파싱
     - 헤더 행 자동 감지
   - 제한사항:
     - Confluence 특수 매크로가 없으면 더 잘 작동
     - 복잡한 중첩 구조는 제한적

## ❌ 현재 지원하지 않는 형식

1. **PowerPoint (PPT/PPTX)**
   - 이유: PPT 파서가 없음
   - 해결 방법:
     - PPT → PDF 변환 후 PDF 업로드
     - 또는 PPT 내용을 텍스트로 복사하여 텍스트 입력

2. **Word 문서 (.docx)**
   - 이유: Word 파서가 없음
   - 해결 방법:
     - Word → PDF 변환 후 PDF 업로드
     - 또는 Word 내용을 텍스트로 복사하여 텍스트 입력
     - Word 표는 HTML로 변환 후 붙여넣기 가능

3. **Excel (.xlsx)**
   - 이유: Excel 파서가 없음
   - 해결 방법:
     - Excel → CSV → 텍스트 변환
     - 또는 Excel 표를 HTML로 복사하여 텍스트 입력에 붙여넣기

4. **이미지 기반 PDF (스캔본)**
   - 이유: OCR 기능 없음
   - 해결 방법:
     - OCR 도구로 텍스트 추출 후 텍스트 입력
     - 또는 PDF → 이미지 → OCR → 텍스트 변환

5. **Markdown 파일 직접 업로드**
   - 현재: 파일 업로드는 PDF만 지원
   - 해결 방법: 파일 내용을 복사하여 텍스트 입력에 붙여넣기

6. **Google Docs / Notion / 기타 위키**
   - 현재: Confluence만 지원
   - 해결 방법:
     - Google Docs/Notion → HTML 복사 → 텍스트 입력
     - 또는 Markdown으로 내보내기 → 텍스트 입력

## 파싱 로직 상세

### 표 파싱 (HTML Table)
- **헤더 행 자동 감지**: "NO", "항목", "속성", "내용" 키워드로 헤더 찾기
- **제목 행 건너뛰기**: `colspan`이 큰 행은 제목으로 간주
- **Confluence 매크로 제거**: `ac:*` 태그 제거
- **UI 텍스트 추출**:
  - 따옴표로 감싼 텍스트 (`"인기순"`)
  - "/" 로 구분된 옵션 (`최신순 / 조회순`)
  - 라벨 제거 (`[1a] 전체 인기순` → `전체 인기순`)

### 텍스트 파싱
- **따옴표 텍스트**: `"텍스트"` 형식 추출
- **UI 키워드 필터링**: 버튼, 필터, 정렬 등 키워드 포함 텍스트만 추출
- **업데이트 정보**: 취소선, 업데이트 날짜 파싱
- **노이즈 필터링**: Footer, Policy, 고정 문구 제외

## 개선 제안

### 단기 개선 (쉬움)
1. **Markdown 파일 업로드 지원**
   - `.md` 파일 업로드 기능 추가
   - 파일 내용을 텍스트로 읽어서 파싱

2. **Excel 표 복사/붙여넣기 지원**
   - Excel에서 표 복사 → HTML로 변환되어 클립보드에 저장됨
   - 텍스트 입력에 붙여넣기 시 HTML 표로 인식

### 중기 개선 (보통)
3. **Word 문서 지원**
   - `mammoth` 라이브러리로 `.docx` → HTML 변환
   - Word 표를 HTML 표로 변환하여 파싱

4. **Excel 파일 지원**
   - `xlsx` 라이브러리로 `.xlsx` 파일 읽기
   - 시트별 표 추출 및 파싱

### 장기 개선 (어려움)
5. **PowerPoint 지원**
   - `pptx` 라이브러리로 슬라이드 텍스트 추출
   - 표가 있는 슬라이드만 추출

6. **OCR 지원 (이미지 PDF)**
   - `tesseract.js` 또는 클라우드 OCR API 연동
   - 스캔본 PDF에서 텍스트 추출

7. **다양한 위키 지원**
   - Notion API 연동
   - Google Docs API 연동
   - 일반 HTML 위키 지원

## 현재 코드의 강점

1. **유연한 파싱**: HTML 표와 텍스트를 모두 처리
2. **섹션 선택**: 위키에서 원하는 부분만 추출 가능
3. **표 구조 인식**: 헤더 행 자동 감지로 다양한 표 형식 지원
4. **노이즈 필터링**: 불필요한 텍스트 자동 제거

## 현재 코드의 한계

1. **파일 형식 제한**: PDF만 직접 업로드 가능
2. **위키 제한**: Confluence만 지원
3. **표 구조 손실**: PDF에서 추출한 표는 구조 정보 손실
4. **이미지 미지원**: 이미지 내 텍스트 추출 불가
